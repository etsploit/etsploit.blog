---
title: "Create a Nessus Vulnerability Management Lab"
date: 2022-05-05T10:40:32-04:00
draft: false
tags: ["Nessus", "Vuln"]
categories: ["CyberSec"]
---
## Objective: Create a vulnerability management lab from an Ubuntu box

![Nessus Scan](https://publish-01.obsidian.md/access/3d2dc72f28193f2ce7183f25d94f1d36/%E2%9C%8D%F0%9F%8F%BE%20Blogs/Attachments/Screenshot%20from%202022-04-17%2000-00-38.png?ts=1651813200000&sig=8993ca4cb676d90237a1075f60852bbd5fe0f7f2ef60bac707870cb799314c2c)

I included more screenshots in my notes [here](https://notes.etsplo.it/%E2%9C%8D%F0%9F%8F%BE+Blogs/Create+a+Nessus+Vulnerability+Management+Lab)

Github Project Link: <https://github.com/users/etsploit/projects/8>

Reference Video:
<iframe width="560" height="315" src="https://www.youtube.com/embed/lT6Px9zJM3s" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

Note: Josh is doing this tutorial from a Windows Host, I'm actually giving instructions from an Ubuntu box which will be slightly different

### Prep Steps, Install Virtualization, Nessus, Windows

1. Download VMware Player <https://www.vmware.com/products/workstation-player/workstation-player-evaluation.html>
2. Download Windows 10 ISO <https://www.microsoft.com/en-us/software-download/windows10ISO>
3. Download Nessus Essentials <https://www.tenable.com/products/nessus/nessus-essentials>

- The tutorial ran this from a Windows Host Machine, I'm running Ubuntu locally so opted for the Ubuntu 20.04 Nessus debian package

3. Got to make the .bundle file executable (the VMWare File)
4. Install VMware Player (run bundle script like this: ./my_shell_script)

```
chmod +x VMware-Player-Full-16.2.3-19376536.x86_64.bundle
sudo ./VMware-Player-Full-16.2.3-19376536.x86_64.bundle
```

5. Get Nessus running on Ubuntu

```
cd Downloads
sudo apt install ./Nessus*_amd64.deb
sudo systemctl enable --now nessusd
sudo systemctl status nessusd
sudo ufw allow 8834
```

6. Go to <https://localhost:8834/#/>

- Might want to remember to close that port later

### Set Up Dummy Windows VM

7. Install Windows 10 as a VM on your host machine

- this will be the machine we will be scanning with Nessus

8.  Run ```ipconfig``` within the Dummy Windows VM to find your IP
9.  Ping that IP from your host Ubuntu machine (it will fail)
10.  Gotta lower the firewall in Windows so you can get connected
11.  Ping again, it should go thru

### Scan IP with Nessus

12. Use the Dummy Windows IP as your target for a basic Nessus Scan
13. Configure the VM for credentialed scans (these next steps)
14. Enable Remote Registry from Windows Services
15. Open Registry Editor and Add a DWORD
16. Create LocalAccountTokenFilterPolicy, Set Value to 1
17. Restart your Windows Dummy VM
18. Scan Again

### Installing Deprecated Software on Dummy Windows VM

Why? By installing old junk you will quickly be able to the basic process for spotting vulnerabilities and remediating them. As such, often vulnerabilities a simply because of old software...in this case Firefox.

19. Install old Firefox version from <https://ftp.mozilla.org/pub/firefox/releases/3.6.12/win32/en-US/> on your Dummy Windows VM
20. Scan Again...see the fuckery
21. Remove Firefox, update Windows, and now you've remediated shit

<mark>What's The Point of All of This?</mark>
The value in this exercise is getting some hands-on working knowledge of the Nessus scanning tool especially if you've never used it before. Working as an assessor as well as vulnerability scanning engineer it can be helpful to understand how Nessus works and outputs even if I'm not running scans everyday. Also there is entire career field and skill in vulnerability management for those interested. These orgs need it!
